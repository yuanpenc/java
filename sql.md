
### sql训练
https://www.bilibili.com/video/BV1sE41147eG?p=4
1.按照部门编号分组，查询最高薪水。 一个表。

```
//生成一个临时表
SELECT DEPTNUM, MAX(SAL) MAXSAL FROM EMP GROUP BY DEPTNUM;

//连接查询

SELECT 
T.DEPTNUM,T.MAXSAL,E.EMPNUM,E.ENPNA
FROM EMP E
INNER JOIN (SELECT DEPTNUM, MAX(SAL) MAXSAL 
            FORM EMP GROUP BY DEPTNUM) T ON (E.DEPTNUM=T.DEPTNUM AND E.SAL = T.MAXSAL);
```

2.哪些人的薪水在部门平均薪水之上。


 ```
 //按照部门编号分组查询平均薪水
 SELECT DEPTNUM, AVG(SAL) AVGSAL FROM EMP GROUP BY DEPTNUM;
 
 //连接查询
 SELECT T.DEPTNUM, T.AVGSAL, E.EMPNUM, E.ENPNA
 FROM EMP E 
 INNER JOIN (SELECT DEPTNUM, AVG(SAL) AVGSAL FROM EMP GROUP BY DEPTNUM) T
 ON (E.DEPTNUM=T.DEPTNUM AND E.SAL>T.AVGSAL)
 ORDER BY T.DEPTNUM;
 ```
